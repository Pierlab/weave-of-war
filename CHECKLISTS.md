# Vertical Slice P0 Execution Checklist (2025 Refresh)

This checklist replaces the earlier milestone summary and expands every deliverable required to land the Vertical Slice P0 described in `docs/project_spec.md`, the mission brief `docs/agents/missions/vertical_slice_p0.md`, and the SDS/TDD artefacts.

> **How to use this document**
> 1. Progress strictly from the first numbered task to the last—do not skip ahead unless a dependency explicitly says so.
> 2. After completing a task, update the linked artefacts (mission brief, docs, tests) before checking it off.
> 3. Capture validation evidence (logs, screenshots, recordings) in `docs/agents/missions/vertical_slice_p0.md` as you go.

> **Legend**
> `[ ]` = pending · `[~]` = in progress (replace the space with `~`) · `[x]` = complete with validation evidence linked in mission notes.

## Phase 0 — Alignment, Data Hygiene, and Instrumentation Foundations
1. [x] **Re-align scope and mission context.** Re-read `docs/project_spec.md`, `docs/agents/missions/vertical_slice_p0.md`, and the latest `context_snapshot.md`. Log any scope delta or open risk in `context_update.md` under a new dated bullet. *(2025-11-01 — Scope aligned; no new risks beyond existing Godot binary provisioning blocker.)*
2. [x] **Catalogue data gaps.** Audit every `data/*.json` file against SDS expectations (doctrines, orders, units, weather, logistics, formations, competence sliders). Record missing fields/inconsistencies in the mission brief under a "Phase 0 findings" heading. *(2025-11-02 — Documented gaps per dataset in mission brief Phase 0 findings.)*
3. [x] **Harden DataLoader validation.** Update `DataLoader` schemas and gdUnit tests so that all JSON documents used in P0 validate required enums/keys before consumption. *(2025-11-03 — `DataLoaderAutoload.validate_collection()` enforces schema + enum checks, and new gdUnit coverage (`test_data_loader_validation_reports_missing_keys`, `test_data_loader_validation_accepts_valid_payload`) verifies failures/success.)*
4. [x] **Verify autoload readiness.** Confirm `EventBusAutoload`, `DataLoaderAutoload`, `TelemetryAutoload`, and `AssistantAIAutoload` are registered in `project.godot`, emit baseline signals during startup, and surface no warnings. Capture an editor/headless log excerpt proving success. *(2025-11-04 — Autoload names normalised in `project.godot`, gdUnit coverage checks configuration + readiness signals, and startup instrumentation captured in `docs/logs/autoload_readiness_2025-11-04.log`.)*
5. [x] **Stabilise HUD audio feedback.** Rework `_play_feedback()` and related helpers to start streams, guard playback, and stop/clear safely. Attach a short validation log or clip demonstrating clean console output after repeated doctrine/order swaps. *(2025-11-05 — Deferred queue drains the generator only when inactive, guarded by `docs/logs/hud_audio_feedback_2025-11-05.log`.)*

## Phase 1 — Command Model & Élan Core Loop
6. [x] **Lock doctrine catalogue.** Ensure doctrine names (Force/Ruse/Patience/Vitesse/Équilibre) and metadata in `data/doctrines.json` match SDS rules. Update localisation strings or HUD labels as needed. *(2025-11-06 — Added full doctrine entries with command profiles and aligned logistics synergies in `data/doctrines.json`/`data/logistics.json`.)*
7. [x] **Enrich orders dataset.** Expand `data/orders.json` with Élan costs, doctrine requirements, and AI intent metadata aligned with the SDS. Document any new fields in the mission brief. *(2025-11-07 — Added CP costs, base delays, doctrine gating, targeting/posture scopes, assistant metadata, and updated DataLoader/tests/docs.)*
8. [x] **Document HUD UX copy.** Capture doctrine/order text, audio cues, and accessibility notes in the HUD section of `README.md`. *(2025-11-08 — Documented doctrine/order copy, feedback colours, audio cues, and accessibility hints in the README HUD section.)*
9. [x] **Wire core systems.** Instantiate `DoctrineSystem` and `ElanSystem` within `GameManager` using typed references. Ensure both wait for `data_loader_ready` before setup logic runs (add assertions/logs as proof). *(2025-11-09 — `GameManager` now defers Doctrine/Élan setup until `data_loader_ready`, asserts the payload, prints readiness logs, and starts the turn loop only after the handshake.)*
10. [x] **Enforce command rules.** Implement doctrine inertia and Élan caps per SDS, exposing current inertia/Élan totals on the HUD (labels/tooltips). Include screenshots in mission notes. *(2025-11-10 — Doctrine inertia now honours SDS multipliers, Élan caps apply doctrine bonuses with decay warnings, HUD labels/tooltips surface inertia + cap states, and evidence recorded in the mission brief.)*
11. [x] **Connect HUD interactions.** Link HUD selectors to `EventBusAutoload` so doctrine swaps/orders raise signals, and present validation errors in-line when rules fail. *(2025-11-11 — Les sélecteurs doctrine/ordre dispatchent désormais les requêtes EventBus, restaurent le choix précédent si l'inertie bloque le swap, et les tooltips détaillent l'Élan manquant pour exposer la validation directement dans la HUD.)*
12. [x] **Propagate orders to Assistant AI.** Confirm `AssistantAIAutoload` receives issued orders and logs interpretations accessible from the debug overlay. *(2025-11-12 — AssistantAIAutoload now records the last 10 packets and the debug overlay renders a scrollable log with order name, target, intent, and confidence for every execution.)*
13. [x] **Automate verification.** Add gdUnit tests covering doctrine change success/failure, Élan gain/spend limits, and assistant acknowledgements. Store command output hashes/paths in mission notes. *(2025-11-13 — Added stubbed gdUnit coverage in `tests/gdunit/test_command_elan_loop.gd` for doctrine gating, Élan spend validation, and Assistant AI packets; command outputs pending local Godot provisioning.)*
14. [x] **Instrument telemetry.** Emit structured payloads for `doctrine_selected`, `order_issued`, `order_rejected`, `elan_spent`, and `elan_gained`. Update telemetry schemas/docs accordingly. *(2025-11-14 — `EventBus` now broadcasts dedicated `order_rejected`/`elan_gained` signals, `TelemetryAutoload` normalises the command-loop payloads, and docs/tests were refreshed to lock the new schema.)*
15. [x] **Update manual checks.** Extend `docs/tests/acceptance_tests.md` with steps for doctrine selection, order issuance, and telemetry review. *(2025-11-15 — AT-07 détaille désormais le swap de doctrine, l'émission d'ordres et la vérification du buffer `TelemetryAutoload`.)*

## Phase 2 — Logistics Backbone with Terrain & Weather Layering
16. [x] **Bootstrap LogisticsSystem.** Instantiate the logistics controller within `GameManager`, wiring turn update hooks and HUD toggles via `EventBusAutoload`. *(2025-11-16 — `GameManager` now spins up `LogisticsSystem`, shares the autoload instances, and gdUnit coverage (`test_game_manager_logistics_bootstrap.gd`) locks the turn/toggle signals.)*
17. [x] **Load logistics data.** Parse rings, nodes, and convoy routes from `data/logistics.json`; create gdUnit assertions that every scenario graph is connected. *(2025-11-17 — `LogisticsSystem` ingests the new supply center/route graphs and `tests/gdunit/test_logistics_data_connectivity.gd` locks connectivity.)*
18. [x] **Animate supply flows.** Render ring pulses and moving convoy sprites with state-dependent colouring (supply OK/at risk/broken). Capture GIF or screenshot evidence. *(2025-11-18 — `LogisticsOverlay` now paints pulsing supply rings and animates convoy markers from `logistics_update` payloads, swapping to red crosses when interceptions occur; screenshot capture deferred because the container is headless, see mission brief for details.)*
19. [x] **Publish logistics updates.** Emit `logistics_update` signals containing reachable tiles, supply deficits, and convoy statuses each turn. Document payload examples in mission notes. *(2025-11-19 — `LogisticsSystem` now enriches the payload with `reachable_tiles`, `supply_deficits`, and `convoy_statuses`; mission brief documents a sample turn payload and acceptance tests mention the new fields.)*
20. [x] **Attach terrain metadata.** Extend map tiles to include Plains/Forest/Hill descriptors sourced from data, and surface tooltips in HUD/debug overlay. *(2025-11-20 — `data/terrain.json` fournit les biomes, la carte affiche les noms/coûts et les tooltips HUD/debug résument les terrains.)*
21. [x] **Implement weather controller.** Cycle through Sunny/Rain/Mist (plus optional Snow/Storm hooks) using deterministic seeds for tests; expose state on HUD icons. *(2025-11-21 — `WeatherSystem` orchestre la rotation seeded, publie les modificateurs restants, HUD météo colorée + test gdUnit dédiés.)*
22. [x] **Link weather to logistics.** Apply weather modifiers to logistics throughput/convoy vulnerability as per SDS and log the adjustments for QA. *(2025-11-22 — `LogisticsSystem` now folds weather/scenario penalties into flow multipliers, surfaces per-route `intercept_risk`, and emits a `weather_adjustments` breakdown in each `logistics_update` payload.)*
23. [x] **Emit weather telemetry.** Send `weather_changed` events with applied modifiers and record schemas. *(2025-11-23 — `TelemetryAutoload` consigne désormais un payload normalisé `weather_changed`, tests gdUnit vérifient la capture et le plan dashboard liste les champs clés.)*
24. [x] **Extend automated tests.** Add gdUnit coverage for logistics reachability, convoy interception hooks, and weather rotation cadence; commit outputs. *(2025-11-24 — Added targeted cases in `tests/gdunit/test_logistics_system.gd` validating reachability shrinkage under storms, single-shot convoy intercept breaks, and logistics-driven weather rotation cadence.)*
25. [x] **Refresh manual tests.** Update `docs/tests/acceptance_tests.md` with logistics overlay toggles, terrain tooltip checks, and weather-driven changes. *(2025-11-25 — AT-08 à AT-10 détaillent désormais la double bascule HUD/debug, les tooltips terrain dynamiques et les impacts météo/logistiques.)*

## Phase 3 — Combat (3 Pillars)
26. [x] **Instantiate CombatSystem.** Wire combat to order execution events plus logistics/weather/espionage signals via `EventBusAutoload`. *(2025-11-30 — `GameManager` ajoute désormais `CombatSystem`, relie `order_execution_requested`/`order_issued`/`logistics_update`, et les résolutions de combat incluent un bloc télémétrie `logistics` pour exposer flow/supply/severity.)*
27. [x] **Implement pillar maths.** Encode Position/Impulse/Information calculations using doctrine, formation, terrain, weather, and intel modifiers exactly as SDS specifies. Annotate formulas in mission notes. *(2025-12-01 — Refactored `CombatSystem` pillar resolver with doctrine focus, logistics severity, movement cost, and intel multipliers; formulas documented in the mission brief.)*
28. [x] **Build combat UI.** Deliver HUD panels/modals showing gauges, textual summaries, and Élan adjustments; capture UI screenshots. *(2025-12-02 — HUD "Dernier engagement" panel affiche les piliers, le contexte logistique et les deltas d'Élan; capture écran à réaliser hors conteneur headless.)*
29. [x] **Record telemetry.** Emit `combat_resolved` payloads with per-pillar breakdowns and resulting unit states. *(2025-12-03 — Payload enrichi avec `pillar_summary` et `units`, sérialisé par `TelemetryAutoload`, gdUnit vérifie la structure.)*
30. [x] **Automate combat checks.** Write gdUnit scenarios covering deterministic outcomes, tie-breakers, and edge cases. Archive result summaries. *(2025-12-04 — Ajouté `tests/gdunit/test_combat_resolution.gd` couvrant la reproductibilité par seed, les égalités 1-1-1 et l'impact logistique critique sur les pertes.)*
31. [x] **Document combat loop.** Update `README.md` and the mission brief with instructions for triggering combat and interpreting results. *(2025-12-05 — README décrit désormais le flux HUD → CombatSystem → Telemetry avec étapes pas-à-pas; mission brief Phase 3 rappelle l'inspection via Remote Debugger et lie l'item 31.)*

## Phase 4 — Espionage & Fog of War
32. [x] **Spawn EspionageSystem.** Ensure it initialises alongside combat/logistics systems and updates fog state each turn. *(2025-12-08 — GameManager instantiates EspionageSystem, seeds fog from terrain data, and a gdUnit regression confirms turn-syncing telemetry.)*
33. [x] **Render fog visuals.** Dim hidden tiles, hide enemy intel, and keep player territory visible; document shader/material changes if any. *(2025-12-09 — Added a fog overlay polygon to each hex tile, driven by `fog_of_war_updated` events emitted by `EspionageSystem`. Labels/tooltip copy now redact intel when visibility drops below 35%.)*
34. [x] **Design recon flows.** Implement reconnaissance/spy orders with Élan/competence costs, integrate them into HUD + assistant pipeline, and log validation rules. *(2025-12-10 — Added `recon_probe`/`deep_cover` orders with competence budgets, HUD tooltips, automatic `espionage_ping`, and validation in DataLoader/tests.)*
35. [x] **Generate intel feedback.** Produce probabilistic pings with intent categories surfaced via HUD notifications and debug overlay timelines. *(2025-12-11 — HUD "Renseignements" + timeline debug exposent roll/probabilité, intention révélée et deltas de visibilité pour chaque ping.)*
36. [x] **Instrument espionage telemetry.** Emit `espionage_ping` and `intel_intent_revealed` events, preserving history in telemetry buffers. *(2025-12-12 — Added `intel_intent_revealed`, normalised telemetry payloads with history accessors, and wired HUD/debug feedback.)*
37. [x] **Test espionage systems.** Add gdUnit coverage for fog toggling, ping probability distribution, and intel decay. Attach outputs to mission notes. *(2025-12-13 — Expanded `tests/gdunit/test_combat_and_espionage_systems.gd` with fog snapshot regression, probabilistic ping sampling, and intel decay clamps.)*

## Phase 5 — Competence Sliders (Tactics / Strategy / Logistics)
38. [x] **Extend TurnManager.** Track competence budget, inertia, and modifiers following SDS guidelines; expose state to HUD/telemetry. *(2025-12-14 — `TurnManager` consomme `data/competence_sliders.json`, verrouille les deltas par tour/inertie, publie `inertia`/`modifiers` dans `competence_reallocated`, ajoute les tests gdUnit et met à jour docs & datasets.)*
39. [x] **Ship HUD sliders.** Build slider controls with visual feedback and keyboard/controller shortcuts; capture interaction clips. *(2025-12-15 — HUD Compétence panel delivers dynamic sliders, event bus allocation requests/failures, keyboard/D-pad shortcuts, and refreshed docs/checklist evidence.)*
40. [x] **Propagate slider effects.** Apply slider values to combat impulse, assistant AI planning, and logistics efficiency. *(2025-12-16 — Tactics ratios boost the combat impulse multiplier, Assistant AI packets now expose competence-aligned confidence, and `LogisticsSystem` scales its flow multiplier via `competence_multiplier` with gdUnit coverage.)*
41. [x] **Emit competence telemetry.** Publish `competence_reallocated` events with before/after values and turn IDs. *(2025-12-17 — `TurnManager` émet désormais un `turn_id` unique et des instantanés `before`/`after` (allocations, budget, inertie, modificateurs) que `TelemetryAutoload` sérialise pour les HUD/tests/dashboards.)*
42. [x] **Automate slider behaviour.** Cover inertia constraints and downstream effects via gdUnit tests; store logs. *(2025-12-18 — Added gdUnit coverage for EventBus allocation requests, asserting delta/inertia failures emit `competence_allocation_failed` and successful reallocations propagate updated payloads without regressions.)*
43. [x] **Update documentation.** Expand `README.md` and acceptance tests with slider usage guidance and expected outcomes. *(2025-12-19 — Added a "Competence slider usage guide" walkthrough to the README and a paired AT-16 manual test capturing the documented loop.)*

## Phase 6 — Unit Formations & Postures
44. [ ] **Load formation definitions.** Map `data/formations.json` entries to unit archetypes and document the mapping.
45. [ ] **Implement formation controls.** Provide HUD interactions (dropdown/radial) respecting Élan costs and inertia delays.
46. [ ] **Integrate with combat.** Ensure `CombatSystem` consumes formation data when computing pillar modifiers; verify via logs/tests.
47. [ ] **Visualise formation changes.** Update map visuals/icons when formations shift; capture assets in mission notes.
48. [ ] **Emit formation telemetry.** Publish `formation_changed` events linked to combat outcomes.
49. [ ] **Test formation flows.** Add gdUnit coverage validating transitions, costs, and combat influence; archive results.

## Phase 7 — Telemetry, Analytics, and Assistant AI Insights
50. [ ] **Review telemetry schemas.** Cross-check all emitted events for schema consistency and update `docs/telemetry/dashboard_plan.md` with KPI dashboards.
51. [ ] **Persist telemetry buffers.** Extend `TelemetryAutoload` to persist session buffers (or stub) and document storage paths in README + mission brief.
52. [ ] **Enhance Assistant AI logging.** Record reasoning traces for orders, espionage suggestions, and logistics alerts; provide sample logs.
53. [ ] **Expose inspection tooling.** Add debug overlay panels or tooling to review telemetry buffers and assistant suggestions during playtests; capture screenshots.

## Phase 8 — Quality Assurance & Delivery Rituals
54. [ ] **Run mandatory headless commands.** Execute the three Godot headless scripts and save logs alongside the mission brief:
    - [ ] `godot --headless --path . --script res://scripts/ci/gd_lint_runner.gd`
    - [ ] `godot --headless --path . --script res://scripts/ci/gd_build_check.gd`
    - [ ] `godot --headless --path . --script res://scripts/ci/gdunit_runner.gd`
55. [ ] **Complete manual QA sweep.** Perform HUD interactions, logistics overlay toggles, combat resolutions, espionage pings, slider adjustments, and formation swaps; attach screenshots/GIFs.
56. [ ] **Refresh canonical docs.** Update `context_update.md`, append CHANGELOG/README notes, and regenerate `context_snapshot.md` after validation.
57. [ ] **Summarise in mission brief.** Document completion status, risks, and evidence links in `docs/agents/missions/vertical_slice_p0.md`.
58. [ ] **Prepare PR package.** Draft the PR description using the template in `docs/vibe_coding.md`, referencing checklist items and providing test logs.
