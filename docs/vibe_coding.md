# Weave of War — Vibe Coding Playbook (2024 refresh)

> Purpose: keep the project comfortable for coding agents by combining lightweight rituals, living documentation, automated
guards, and detailed checklists that keep larger features safe.

## 1. Quick-start ritual for every mission
1. Read the latest [`context_snapshot.md`](../context_snapshot.md) to reload the state of the project after the previous merge.
2. Open the mission brief inside `docs/agents/missions/` that matches your scope and review its checklist.
3. Skim [`context_update.md`](../context_update.md) to understand what changed in the active PR (update it as you work).
4. Revisit [`docs/project_spec.md`](project_spec.md) and this playbook to stay anchored in the product vision and rituals.
5. When creating a new mission, duplicate [`docs/agents/agent_base.md`](agents/agent_base.md) and tailor the checklist.

## 2. Standard vibe-coding loop
1. **Align**
   - Confirm the mission goal, constraints, and acceptance criteria from the mission file.
   - Note the latest changelog entry to understand the current release story.
2. **Plan with a checklist**
   - Draft a granular checklist covering analysis, implementation, tests, docs, and follow-ups.
   - Store the checklist in the mission file and reference it in the PR body.
3. **Code in vibes**
   - Implement one checklist item at a time.
   - After finishing an item, run its validations, update docs, and tick it off with a short note in the mission file.
   - If the scope changes, pause and realign the checklist before writing more code.
4. **Validate**
   - Run the automated commands from section 4 plus any feature-specific checks.
   - Capture logs, screenshots, or recordings that help reviewers.
5. **Document & share**
   - Update the changelog, context update, and any docs touched by the feature.
   - Summarise the work in the PR description using the template below and mention follow-up tasks.

## 3. Context artefacts to maintain
- **`context_snapshot.md`** — generated by `python scripts/generate_context_snapshot.py`. Commit the refreshed snapshot at the end
  of every PR.
- **`context_update.md`** — living notes for the current branch/PR. Update it after each significant change.
- **`CHANGELOG.md`** — human-friendly history of releases. Append a bullet under the current heading.
- **Mission files** — update `docs/agents/missions/<mission>.md` whenever the plan, checklist, or status evolves.

## 4. Testing expectations (automated + manual)
- Automated tests live under `res://tests/` and run through the lightweight gdUnit-style harness.
- Mandatory commands (Godot 4.x headless):
  ```bash
  godot --headless --path . --script res://scripts/ci/gd_lint_runner.gd
  godot --headless --path . --script res://scripts/ci/gd_build_check.gd
  godot --headless --path . --script res://scripts/ci/gdunit_runner.gd
  ```
- Manual acceptance checks still reference [`docs/tests/acceptance_tests.md`](tests/acceptance_tests.md). Keep that file aligned
  with reality and note any deviations in the mission brief.
- If a test fails or cannot be executed locally, document the reason in `context_update.md` and propose a follow-up.

## 5. Continuous integration & automation
- GitHub Actions (`.github/workflows/ci.yml`) run the same headless commands on every push.
- The workflow also ensures `context_snapshot.md` stays in sync; run the generator before opening a PR to avoid CI failures.
- Extend the workflow when new automated checks (profiling, linting, export) become available.

## 6. Documentation & knowledge hygiene
- Update `README.md` whenever onboarding steps, tooling, or rituals change.
- Reflect system updates in `docs/project_spec.md` or add an ADR if architecture evolves.
- Keep `docs/tests/acceptance_tests.md` aligned with actual behaviour after every functional change.
- Add or update mission briefs in `docs/agents/missions/` to capture scope decisions and open questions.

## 7. PR template
Use this structure in every PR description:
```
## What
## Why (player impact)
## How (key files & systems)
## Tests (commands + expected output)
## Documentation updates
## Risks / Rollback
## Context update summary (link to context_update.md section)
```

Following this playbook keeps the Weave of War project calm, transparent, and ready for larger systems work without losing our
creative vibe.
